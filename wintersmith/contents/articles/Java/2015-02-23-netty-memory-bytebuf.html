---
date: 2015-02-23 17:12:31
template: tech.jade
title: Netty 内存管理 —— ByteBuffer
category: Java
chage_frequency: monthly
tag: Java, Netty
---
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">ByteBuffer</a>
<ul>
<li><a href="#sec-1-1">UnpooledByteBuffer</a></li>
<li><a href="#sec-1-2">PooledByteBUffer</a></li>
<li><a href="#sec-1-3">DirectedByteBuffer</a></li>
<li><a href="#sec-1-4">HeapByteBuffer</a></li>
<li><a href="#sec-1-5">UnsafeDirectedByteBuffer</a></li>
<li><a href="#sec-1-6"><span class="todo TODO">TODO</span> PoolChunk</a></li>
<li><a href="#sec-1-7"><span class="todo TODO">TODO</span> PoolArena</a></li>
</ul>
</li>
</ul>
</div>
</div>

<p>
网络编程难免会使用ByteBUffer，Netty中对ByteBuffer自己做了封装，独立与Java Nio的byteBuffer，总的来说，ByteBuffer分为几种：
</p>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">ByteBuffer</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">UnpooledByteBuffer</h3>
<div class="outline-text-3" id="text-1-1">
<p>
无缓存，使用过后直接可以被回收
</p>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">PooledByteBUffer</h3>
<div class="outline-text-3" id="text-1-2">
<p>
有缓存，使用Recycler进行缓存
</p>
</div>
</div>
<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">DirectedByteBuffer</h3>
<div class="outline-text-3" id="text-1-3">
<p>
堆外内存。
</p>

<p>
可以通过使用Jvm参数： <code>-XXMaxDirectMemorySize=256G</code> 来设置堆外内存的值，如果未设置，则与堆大小一致。
</p>
</div>
</div>
<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4">HeapByteBuffer</h3>
<div class="outline-text-3" id="text-1-4">
<p>
堆内存
</p>
</div>
</div>
<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5">UnsafeDirectedByteBuffer</h3>
<div class="outline-text-3" id="text-1-5">
<p>
平台相关的堆外内存
</p>
</div>
</div>

<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6"><span class="todo TODO">TODO</span> PoolChunk</h3>
</div>

<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7"><span class="todo TODO">TODO</span> PoolArena</h3>
</div>
</div>
