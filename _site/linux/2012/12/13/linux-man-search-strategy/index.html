<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Linux man 命令查找man手册的策略</title>
    <link rel="stylesheet" href="/stylesheets/styles.css">
    <link rel="stylesheet" href="/stylesheets/pygments.css">
    <script src="/javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
      <h1 class="header"><a href=/>ChinaXing</a></h1>
      <ul>
        <li><a class="buttons github" href="https://github.com/chinaxing">github profile</a></li>
      </ul>
      <p class="header">文章分类
      <a href=/search.htm>
        <img style="float:right;margin:0;margin-top:8px;border:0;padding:0;" 
        src=http://www.google.com/uds/css/v2/search_box_icon.png />
      </a>
      </p>
      <ul>
        
        <li>
        <a href="/categories/linux/">linux</a>
        <span style="float:right">[4]</span>
        </li>
        
        <li>
        <a href="/categories/jekyll/">jekyll</a>
        <span style="float:right">[2]</span>
        </li>
        
        <li>
        <a href="/categories/github/">github</a>
        <span style="float:right">[2]</span>
        </li>
        
        <li>
        <a href="/categories/git/">git</a>
        <span style="float:right">[1]</span>
        </li>
        
        <li>
        <a href="/categories/life/">life</a>
        <span style="float:right">[1]</span>
        </li>
        
        <li>
        <a href="/categories/postgres/">postgres</a>
        <span style="float:right">[2]</span>
        </li>
        
        <li>
        <a href="/categories/django/">django</a>
        <span style="float:right">[1]</span>
        </li>
        
        <li>
        <a href="/categories/Perl/">Perl</a>
        <span style="float:right">[1]</span>
        </li>
        
      </ul>
      </header>
      <section>
      <h1 style="border:0;text-align:center;color:#C3001D;font-weight:bold">
  Linux man 命令查找man手册的策略
</h1>
<p>本文的知识是从man man命令得到。在这里记录只为了备忘和方便，可以使用man man
来获得纤细的说明。</p>

<p>man 命令是我们经常使用的一个命令，那么当你执行:<code>man [command]</code>的时候，
man命令是如何查找命令的手册呢？</p>

<p>根据man命令的帮助文档，我得到了如下信息:</p>

<h3>查找策略</h3>

<p>man 命令查找命令帮助手册的策略:</p>

<ul>
<li>命令行指定<strong>-M</strong>参数，那么man命令使用这个目录搜索。否则,</li>
<li>使用<strong>MANPATH</strong>环境变量指定的路径进行搜索.否则,</li>
<li>查看/etc/man.config，找到其中的<strong>MANPATH</strong>配置，加入搜索路径. 然后,</li>
<li>查看/etc/man.config, 找到其中的<strong>MANPATH_MAP</strong>配置，加入搜索的"Map"路径，然后,</li>
<li>遍历<strong>PATH</strong>变量中的每个路径,对不在<strong>MANPATH_MAP</strong>中的路径, 执行"nearby"查找。</li>
<li>在搜索路径中进行查找.</li>
</ul>


<h3>说明:</h3>

<ol>
<li><p>"Map"路径:<br/>
这种路径相当于一张hash表，前面是命令所在的PATH搜索路径，后面是man手册的查找路径，man 会根据这个hash表查找该命令的man手册. <br/>
<strong>举例</strong>:</p>

<ol>
<li><p>设置:<code>MANPATH_MAP /home/admin/git/bin /home/admin/git/man/</code><br/>
当执行: <code>man git</code> 的时候，<strong>man</strong>会根据<strong>PATH</strong>查找<code>git</code>这个命令的位置，在<code>/home/admin/git/bin</code>下找到了,
所以根据设置的hash表，在<code>/home/admin/git/man</code>这个路径下查找git的手册.</p></li>
<li><p>设置:<code>MANPATH_MAP /bin /home/admin/git/man</code><br/>
但执行: <code>man git</code> 的时候，<strong>man</strong>会根据<strong>PATH</strong>查找<code>git</code>命令的位置，在<code>/home/admin/git/bin</code>下面找到了，但是根据hash，
没有这个路径对应的man手册搜索路径，所以这条MANPATH_MAP不会被使用.</p></li>
</ol>
</li>
<li><p>man查找对象:<br/>
 查找对象为<code>topic.section</code>,如果没找到，则查找<code>man[section]/topic.section</code>,如:<code>man1/git.1</code> .</p></li>
<li><p>nearby查找:<br/>
 nearby查找查找什么呢？<br/>
 通过我实验，会在本目录先查找<code>man</code>,如果没找到, 然后查找<code>man[section]</code>目录<br/>
 如果找到<code>man[section]</code>目录则将当前目录加入搜索路径,找到<code>man</code>目录将<code>当前目录/man</code>加入搜索路径.</p></li>
</ol>


<h3>其它</h3>

<p>查看找到的手册的位置:</p>

<pre><code>$ man --path cat
/usr/share/man/man1/cat.1.gz
</code></pre>

<p>查看man命令查找手册的过程:</p>

<pre><code>$ man -D cat
Reading config file /etc/man.config
found man directory /usr/man
found man directory /usr/share/man
found man directory /usr/local/man
found man directory /usr/local/share/man
found man directory /usr/X11R6/man
found manpath map /bin --&gt; /usr/share/man
...
</code></pre>


<div id="disqus_thread" style="padding-top:3em"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'chinaxing'; // required: replace example with your forum shortname

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

      </section>
      <footer>
      <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
  </body>
</html>
